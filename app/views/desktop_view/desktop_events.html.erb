<%= content_for :jj do %>
    <script src="/assets/testing/dashboard/javascripts/application.js" type="text/javascript" xmlns="http://www.w3.org/1999/html"></script>
<% end %>



<div class="container-fluid">
    <div class="row-fluid">
       <div class="span7">
            <div class="row-fluid">
                <div class="span12">
                  <%= render :partial => "list" %>
                </div>
            </div>

      <!----------------------Start of events------------------------------>

            <div class="black-box tex" id="events">
                <div class="tab-header">
                  Events
                  <% if params[:desk]  %>
                      <script type="text/javascript">
                          $(function(){
                              $.gritter.add({
                                  title: 'Hi <% unless current_user.name.nil? %>  <%= current_user.name.titlecase %> <% end %>',
                                  text: 'you have  signed in successfully',
                                  image: '/assets/testing/dashboard/stylesheets/success.png',
                                  sticky: false,
                                  before_open: function(){
                                      if($('.gritter-item-wrapper').length == 3)
                                      {
                                          return false;
                                      }
                                  }
                              });
                          });
                      </script>
                  <% end %>
                </div>

                <ul class="recent-comments">
                  <li class="separator">
                    <br>
                    <ul>
                      <% Track.all.each do |e| %>
                          <div class="nav-menu box" id="categoriesContent">
                            <ul class="nav nav-list">
                              <li>
                                <a href="/events_show/<%= e.id %>">
                                  <h6>
                                    <%= e.name.truncate(40) %>
                                    <span class="pull-right badge black"><%= e.start %></span>
                                  </h6>
                                </a>
                              </li>
                            </ul>
                          </div>
                      <% end %>
                    </ul>
                  </li>
                </ul>
            </div>
      </div>
    <!----------------------End of events------------------------------>

        <div class="span5">
          <div class="row-fluid">
            <div class="span12">
              <%= render :partial => "event_wall" %>
            </div>
          </div>
        </div>

        <div class="span5">
          <div class="row-fluid">
            <div class="span12">
              <%= render :partial => "splash_zone" %>
            </div>
          </div>
        </div>
    </div>

  <script type="text/javascript">

      $(function () {
          $("select#genres_select").prop('selectedIndex', 1);
          $("select#artists_select").prop('selectedIndex', 1);
          event_default();

              $('#artists_select').prop("disabled", true);
              $('#songs_select').prop("disabled", true);
              $('#categoriesContent').hide();

              $('#genres_select').change(function () {
                  var data = {event_day_id:[]}
                  data["event_day_id"].push($('#genres_select').val());
                  $.getJSON("desktop_view/update_track/"+ data["event_day_id"], function(data) {
                      $('#artists_select').empty();
                      $("#artists_select").prepend("<option value='' selected='selected'>Select Track Day</option>");
                      $.each(data, function(key, val) {
                          val=val.split('|');
                          $('#artists_select').append($('<option>', {
                              value:val[0],
                              text:val[1]
                          }));
                      });
                      $('#artists_select').prop("disabled", false);
                      $('#songs_select').prop("disabled", true);
                      $('#categoriesContent').hide();
                  });
              });

              $('#artists_select').change(function () {
                  var data = {event_id:[]}
                  data["event_id"].push($('#artists_select').val());
                  $.getJSON("desktop_view/update_event/"+ data["event_id"], function(data) {
                      $('#categoriesContent ul').html("");
                      $.each(data, function(key, val) {
                          val=val.split('|');
                          $('#categoriesContent').show();
                          $('#categoriesContent ul').append('<li><a href="/events_show/' + val [0] + '"><h6>' + val[1] + '<span class="pull-right badge black">' + val[2] + '</span></h6></a></li>');

                      });

                  });

              });

      });

      function event_default(){
          var data = {event_id:[]}
          data["event_id"].push($('#artists_select').val());
          $.getJSON("desktop_view/update_event/"+ data["event_id"], function(data) {
              $('#categoriesContent ul').html("");
              $.each(data, function(key, val) {
                  val=val.split('|');
                  $('#categoriesContent').show();
                  $('#categoriesContent ul').append('<li><a href="/events_show/' + val [0] + '"><h6>' + val[1] + '<span class="pull-right badge black">' + val[2] + '</span></h6></a></li>');

              });

          });
      }
  </script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-41279198-1', '127.0.0.1:3000');
      ga('send', 'pageview');

  </script>

</div>







