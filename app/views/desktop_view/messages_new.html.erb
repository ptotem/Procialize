<%= content_for :jj do %>
    <script src="/assets/testing/dashboard/javascripts/application.js" type="text/javascript"></script>
<% end %>



<div class="container-fluid">
      <div class="row-fluid">
            <div class="span7">
              <div class="row-fluid">
                <%= render :partial => "list" %>
              </div>

              <!----------------------Start of messages_new------------------------------>

              <div class="black-box tex" >
                <div class="tab-header">Message New</div>
                <ul class="recent-comments">
                  <li class="separator">
                    <%= form_for :message, :html => {:id => "message_form", :class => "fill-up cmxform"} do |f| %>
                        <%= f.hidden_field :conference_id, :value => Conference.last.id %>
                        <%= f.hidden_field :user_id, :value => current_user.id %>
                        <%= f.text_area :body, :rows => '5', :placeholder => "Type your message"%>
                        <br>
                    <% end %>


                    <div class="box" style="position:relative;padding: 10px;color: black;">
                        <table class="table data-table">
                          <thead>
                          <tr>
                            <th>Recepients</th>
                            <th>Select</th>
                            <th class="industry">Industry</th>
                            <th class="industry">Interest</th>
                            <th class="industry">Skills</th>
                            <th class="industry">Location</th>
                            <th class="industry">Email</th>
                            <th class="industry">Headline</th>
                            <th class="industry">Company</th>
                            <th class="industry">Role</th>
                          </tr>
                          </thead>
                          <tbody>
                          <% @users = User.all  %>
                          <% @use = @users - [current_user]  %>

                          <% @use.each do |e| %>
                              <tr class="gradeX"  id="<%= e.id %>">
                                <td><%= e.name %></td>
                                <td><input type="checkbox" class="custom"/></td>
                                <td class="industry"><%= e.industry %></td>
                                <td class="industry"><%= e.interest %></td>
                                <td class="industry"><%= e.skills %></td>
                                <td class="industry"><%= e.location %></td>
                                <td class="industry"><%= e.email %></td>
                                <td class="industry"><%= e.headline %></td>
                                <td class="industry"><%= e.company %></td>
                                <td class="industry"><%= e.role %></td>
                              </tr>
                          <% end %>
                          </tbody>
                        </table>
                    </div><br>
                    <a class="button gray" href="#" class="form_btn" id="form_btn_id">Send</a><br>

                  </li>
                </ul>
              </div>
              <!----------------------End of messages_new------------------------------>
            </div>

            <div class="span5">
              <div class="row-fluid">
                <div class="span12">
                  <%= render :partial => "event_wall" %>
                </div>
              </div>
            </div>

            <div class="span5">
              <div class="row-fluid">
                <div class="span12">
                  <%= render :partial => "splash_zone" %>
                </div>
              </div>
            </div>
      </div>




      <style type="text/css">
          .black-box .separator a{
              color:black;
          }
      </style>


      <script type="text/javascript">

          $('#form_btn_id').on('click', function(){
              if (($(":checkbox").filter(":checked").size()==0))
              {
              <%= add_gritter("Please Select Recepients", :title => "Error!",:image => :warning,:time => 2000  ) %>
              }

              else if ($('#message_body').val()==""){
              <%= add_gritter("Please Fill Message agenda", :title => "Error!",:image => :warning,:time => 2000  ) %>
              }
              else
              {
                  $('#message_form').attr({
                      action:'messages_create',
                      method:'post'
                  });
              <%= add_gritter("Message was successfully sent", :title => "Success",:image => :success,:time => 1000) %>
                  setTimeout(function(){
                      $('#message_form').submit();
                  },1500);

              }
              $('#form_btn_id').hide();
          });


          $(function () {
              $('.custom').live('click',function () {
                  var checked;
                  if ($(this).is(':checked')) {
                      checked = true;
                      var adding = ($(this).parent().parent().attr('id'));
                      var b=($(this).parent().parent().find('#delegates_name').text());
                      $('#search_delegates').text().replace(/Delegates/,"");
                      $('#search_delegates').html($('#search_delegates').text().replace(/Delegates/,"") + b + ", ");
                      $('#message_form').append('<input id='+adding+' type="hidden" name="receipient_users[]" value='+adding+'>');
                  }

                  else {
                      checked = false;
                      var deleting = ($(this).parent().parent().attr('id'));
                      var string = $(this).parent().parent().find('#delegates_name').text();
                      var new_string = $('#search_delegates').text().replace(string+",", '');
                      $('#search_delegates').text(new_string);
                      $('#message_form').find('#'+deleting).empty().remove();
                  }

              });

          });


          $(function(){
              $(".industry").hide();
              $('[type="submit"]').button('disable');
              $(function () {
                  $('[type="submit"]').button('disable');
                  $('select').change && $('#message_body').focus (function () {
                      if (($('select option:selected') && $('#message_body')).length > 0) {
                          $('[type="submit"]').button('enable');

                      } else {
                          $('[type="submit"]').button('disable');

                      }
                  });

              });

              $('#message_body').blur(function () {
                  if ($(this).val().length <= 0) {
                      $('[type="submit"]').button('disable');
                  }
                  else{
                      $('[type="submit"]').button('enable');
                  }
              });

          }) ;
      </script>


  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-41279198-1', '127.0.0.1:3000');
      ga('send', 'pageview');

  </script>

</div>








