
<%= content_for :jj do %>
    <script src="/assets/testing/dashboard/javascripts/application.js" type="text/javascript"></script>
    <%= include_gon %>
<% end %>



<div class="container-fluid">
<div class="row-fluid">
<div class="span7">
<div style="margin-bottom: 20px;">
  <div class="big-button-bar">
    <a class="button large eventer" href="/desktop_events">
      <i class=" icon-calendar "></i>
      <span>Products</span>
    </a>


    <a class="button large delegater" href="/delegates_search">
      <i class="icon-group"></i>
      <span>Attendees</span>
    </a>

    <a class="button large speakinger" href="/desktop_speaker">
      <i class="icon-user"></i>
      <span>Tata Team</span>
    </a>

    <a class="button large questioner" href="/desktop_ask_question">
      <i class="icon-question-sign "></i>
      <span>Questions</span>
    </a>



    <a class="button large downloadables" href="/desktop_assets_download">
      <i class=" icon-folder-open"></i>
      <span>Collateral</span>
    </a>
  </div>
</div>







<!----------------------Start of focus_new----------------------------->

<div class="black-box tex" >
  <ul class="recent-comments">
    <li class="separator">



      <% if !params[:reply]  %>
          <% unless @last_message.body.blank? %>
              <div class="padded" style="min-height: 5em; border:solid 1px black; border-radius: 5px;background: white;color:black;">
                <%= @last_message.body %>
              </div>
          <% end %>
              <br>
          <style type="text/css">
              .black-box .separator a{
                  color:black;
              }
          </style>


          <div class="box" style="position:relative;padding: 10px;color: black;">
            <table class="table data-table">
              <thead>
              <tr>
                <th>Recepients</th>
                <th>Select</th>
              </tr>
              </thead>
              <tbody>
              <% @users = User.all  %>
              <% @use = @users - [current_user]  %>

              <% @use.each do |e| %>
                  <tr class="gradeX"  id="<%= e.id %>">
                    <td><%= e.name %></td>
                    <td><input type="checkbox" class="custom"/></td>
                  </tr>
              <% end %>
              </tbody>
            </table>
          </div>
          <br>
          <!--<a class="button gray" href="#" class="form_btn" id="submit_form">Send</a>-->


          <%= form_for :message, :url=> {:action=> :messages_create},:html => {:class => "meeting  fill-up",:id => "message_forming", :'data-ajax'=>"false"} do |f| %>
              <%= f.hidden_field :conference_id, :value => Conference.last.id %>
              <%= f.hidden_field :user_id, :value => current_user.id %>
              <%= f.hidden_field :body  %>
              <%= f.submit  "Submit",:onclick => "appending_question();" ,:class => "button gray",:style=>"float:left;width:10%;",:id=>"submit_form"%>
          <% end %>

          <script type="text/javascript">
              $('#submit_form').click(function(){
                  if (($(":checkbox").filter(":checked").size()==0))
                  {
                  <%= add_gritter("Please Select Recepients", :title => "Error!",:image => :warning,:time => 2000  ) %>
                      return false;
                  }
                  else{
                  <%= add_gritter("Message Sent Successfully", :title => "Success",:time => 1000) %>
                  }
              });


              function appending_question(){
                  $('#message_body').val( $('.padded').html().replace(/\r/g,'')).replace('/\n/g','');
                  return true;
              }
          </script>
    <% end %>











      <% if !params[:forward] %>
      <%= form_for :message, :url=> {:action=> :messages_create},:html => {:class => "meeting  fill-up",:id => "message_form", :'data-ajax'=>"false"} do |f| %>
          <%= f.hidden_field :conference_id, :value => Conference.last.id %>
          <%= f.hidden_field :user_id, :value => current_user.id %>
          <% if @all %>
              <%#= select_tag 'receipient_users[]', options_for_select(@user_list, @receipients), :multiple => true,:"data-mini" => "true" %>
          <% else %>
              <h5>Select other Recepients</h5>
              <%= select_tag 'receipient_users[]', options_for_select(@user_list, @receipient), :multiple => true,:class=>"send_users" %>
          <% end %>
          <br>
          <%= f.text_area :body, :rows => '5', :placeholder => "Type in your message" %>
          <br>
          <%= f.submit "Send",:class=>"button gray",:style=>"width:15%;",:id=>"add_max" %>
      <% end %>

      <% end %>



      <% if params[:reply] %>
      <script type="text/javascript">



          $(function () {
              $('#add_max').click(function(){
                  $("#message_form").submit(function() {
                      if (($(":checkbox").filter(":checked").size()==0) && ($('.send_users').size()==0))
                      {
                      <%= add_gritter("Please Select Recepients", :title => "Error!",:image => :warning,:time => 2000  ) %>
                          return false;
                      }
                      else {
                      <%= add_gritter("Message Sent Successfully", :title => "Success",:time => 1000) %>
                          setTimeout(function(){
                              $('#message_form').submit();
                          },1500);

                      }

                  });
              });

              $('[type="submit"]').hide();
              $(function () {
                  $('[type="submit"]').hide();
                  $('#message_body').focus (function () {
                      if (( $('#message_body')).length > 0) {
                          $('[type="submit"]').show();

                      } else {
                          $('[type="submit"]').hide();

                      }
                  });

              });

              $('#message_body').blur(function () {
                  if ($(this).val().length <= 0) {
                      $('[type="submit"]').hide();
                  }
                  else{
                      $('[type="submit"]').prop("disabled", false);
                  }
              });

          });

      </script>
        <% end %>

      <script type="text/javascript">
        $(function(){

            $('.custom').live('click',function () {
                var checked;
                if ($(this).is(':checked')) {
                    checked = true;
                    var adding = ($(this).parent().parent().attr('id'));
                    var b=($(this).parent().parent().find('#delegates_name').text());
                    $('#search_delegates').text().replace(/Delegates/,"");
                    $('#search_delegates').html($('#search_delegates').text().replace(/Delegates/,"") + b + ", ");
                    $('#message_forming').append('<input id='+adding+' type="hidden" name="receipient_users[]" value='+adding+'>');
                }

                else {
                    checked = false;
                    var deleting = ($(this).parent().parent().attr('id'));
                    var string = $(this).parent().parent().find('#delegates_name').text();
                    var new_string = $('#search_delegates').text().replace(string+",", '');
                    $('#search_delegates').text(new_string);
                    $('#message_forming').find('#'+deleting).empty().remove();
                }

            });
        })

      </script>
    </li>
  </ul>
</div>
<!----------------------End of focus_new------------------------------>




</div>

<div class="span5">
  <div class="row-fluid">
    <div class="span12">
      <div class="black-box tex" style="max-height: 150px;">
        <div class="tab-header">
          Event Wall
        </div>
        <ul class="recent-comments" style="list-style: none;">
          <% @conference=Conference.last %>
          <% @user=current_user %>
          <% @graffiti=(User.all-(Follower.find_all_by_user_id_and_conference_id(@user.id, @conference.id).map { |f| User.find(f.follower_id) })-[current_user]-Organizer.all.map { |o| o.user }).map { |u| u.posts }.flatten.last(30).sort_by(&:created_at).reverse %>
          <% @graffiti.each do |post| %>

              <li class="separator">
                <div class="avatar pull-left">
                  <% if post.user.picture.blank? %>
                      <%= image_tag "avatar.png" %>
                  <% else %>
                      <%= image_tag(post.user.picture) %>
                  <% end %>
                </div>
                <div class="article-post">
                  <div class="user-info"> Posted
                    by <%= link_to post.user.name.titlecase, delegate_profile_index_path(post.user) %>
                    at <%= post.created_at %> </div>
                  <div class="user-content">"<%= post.name.truncate(10) %>"</div>
                </div>
              </li>
          <% end %>
        </ul>
      </div>
    </div>
  </div>
</div>


<!-------------------------->

<div class="span5">
  <div class="row-fluid">
    <div class="span12">
      <div class="black-box tex" style="max-height: 350px;">
        <div class="tab-header">
          Splash Zone
        </div>
        <script>
            $(document).ready(function() {
                $("#slider1").responsiveSlides({
                    auto:true, // Boolean: Animate automatically, true or false
                    speed:1500, // Integer: Speed of the transition, in milliseconds
                    timeout:4000, // Integer: Time between slide transitions, in milliseconds
                    random:true, // Boolean: Randomize the order of the slides, true or false
                    pause:false, // Boolean: Pause on hover, true or false
                    pauseControls:true, // Boolean: Pause when hovering controls, true or false
                    maxwidth:"", // Integer: Max-width of the slideshow, in pixels
                    navContainer:"", // Selector: Where controls should be appended to, default is after the 'ul'
                    manualControls:"", // Selector: Declare custom pager navigation
                    namespace:"rslides" // String: Change the default namespace used
                });
            });
        </script>

        <style type="text/css">
            .img_style {
                max-height: 200px;
            }
        </style>

        <ul class="recent-comments">
          <li class="separator" style="max-height: 300px;">
            <ul class="rslides" id="slider1">
              <li>
                <% unless HomePageLogo.first.image_one.blank? %>
                    <%= image_tag HomePageLogo.first.image_one.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.image_two.blank? %>
                    <%= image_tag HomePageLogo.first.image_one.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.image_three.blank? %>
                    <%= image_tag HomePageLogo.first.image_one.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.image_four.blank? %>
                    <%= image_tag HomePageLogo.first.image_one.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.image_five.blank? %>
                    <%= image_tag HomePageLogo.first.image_one.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.image_six.blank? %>
                    <%= image_tag HomePageLogo.first.image_six.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.image_seven.blank? %>
                    <%= image_tag HomePageLogo.first.image_seven.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.image_eight.blank? %>
                    <%= image_tag HomePageLogo.first.image_eight.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.image_nine.blank? %>
                    <%= image_tag HomePageLogo.first.image_nine.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.image_ten.blank? %>
                    <%= image_tag HomePageLogo.first.image_ten.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.event_image.blank? %>
                    <%= image_tag HomePageLogo.first.event_image.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.conference_image.blank? %>
                    <%= image_tag HomePageLogo.first.conference_image.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.sponsor_image.blank? %>
                    <%= image_tag HomePageLogo.first.sponsor_image.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.event_one_image.blank? %>
                    <%= image_tag HomePageLogo.first.event_one_image.url, :class => "img_style" %>
                <% end %>
              </li>

              <li>
                <% unless HomePageLogo.first.event_two_image.blank? %>
                    <%= image_tag HomePageLogo.first.event_two_image.url, :class => "img_style" %>
                <% end %>
              </li>

              <% @survey_q= SurveyQuestion.all %>
              <% @survey_q.each do |s| %>
                  <div id="surveys">
                    <li class="img_style" id="<%= s.id %>"><%= s.quest %>
                      <table>
                        <tr>
                          <td><%= radio_button_tag "survey_options", "1", true%></td>
                          <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= s.option_a %></td>

                        </tr>
                        <tr>
                          <td><%= radio_button_tag "survey_options", "2", true%></td>
                          <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= s.option_b %></td>

                        </tr>
                        <% if !s.option_c.blank? %>
                            <tr>
                              <td><%= radio_button_tag "survey_options", "3", true%></td>
                              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= s.option_c %></td>
                            </tr>
                        <% end %>

                        <% if !s.option_d.blank? %>
                            <tr>
                              <td><%= radio_button_tag "survey_options", "4", true%></td>
                              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= s.option_d %></td>
                            </tr>
                        <% end %>
                      </table>
                    </li>
                  </div>
              <% end %>
            </ul>
          </li>
          <li class="separator">

            <marquee id="tweet" style="color: white;">
              "Join TATA Communications at IBC 2013 in Amsterdam"
              <% @newsfeed=NewsFeed.all %>
              <% @newsfeed.each do |n| %>
                  <%= n.feed_news %>
              <% end %>
            </marquee>

          </li>
        </ul>
      </div>
    </div>
  </div>
</div>




<script type="text/javascript">

    $(function () {
        $("input[name=survey_options]").click(function () {
            var a = $(this).parent().parent().parent().parent().parent().parent().attr('id');
            var value = $(this).val();
            var data = { user_id:[], survey_question_id:[], ans:[]}
            data["user_id"].push('<%= current_user.id%>');
            data["survey_question_id"].push(a);
            data["ans"].push(value);
            $.ajax({
                url:"<%= survey_storing_path %>",
                type:"post",
                data:JSON.stringify(data),
                contentType:"application/json",
                success:function (data) {
                    <%= add_gritter("Thank You", :title => "Success",:image => :success,:time => 1000) %>
                }
            });

        });


    });


//    $(function () {
//        $.get('/gettweets', function (data) {
//
//            data = data.split('", "')
//            $.each(data, function (index, val) {
//                val = val.toString().replace(/"/, '').replace('[', '').replace(']', '');
//                $('#tweet').append(val + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;')
//            });
//        });
//
//    });

</script>

</div>
</div>