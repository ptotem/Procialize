<%= content_for :jj do %>
    <script src="/assets/testing/dashboard/javascripts/application.js" type="text/javascript"></script>
<% end %>



<div class="container-fluid">
  <div class="row-fluid">
    <div class="span7">
      <div class="row-fluid">
        <div class="span12">
          <div style="margin-bottom: 20px;">
            <div class="big-button-bar">
              <a class="button large eventer" href="/desktop_events">
                <i class=" icon-calendar "></i>
                <span>Solutions</span>
              </a>


              <a class="button large delegater" href="/delegates_search">
                <i class="icon-group"></i>
                <span>Attendees</span>
              </a>

              <a class="button large speakinger" href="/desktop_speaker">
                <i class="icon-user"></i>
                <span>Tata Team</span>
              </a>

              <a class="button large questioner" href="/desktop_ask_question">
                <i class="icon-question-sign "></i>
                <span>Questions</span>
              </a>


              <a class="button large downloadables" href="/desktop_assets_download">
                <i class=" icon-folder-open"></i>
                <span>Collateral</span>
              </a>
            </div>
          </div>
        </div>
      </div>







      <!----------------------Start of events------------------------------>

      <div class="black-box tex" >
        <div class="tab-header">
          Questions
        </div>
        <ul class="recent-comments">

          <li class="separator">


          <%= collection_select(nil, :track_id, @tracks, :id, :name, {:prompt => "Select the Product"}, {:id => 'songs_select'}) %>


          <%= form_for :questionable, :html => {:id => "question_form",:class => "fill-up"}, url: {action: :desktop_create_question} do |f| %>
                <%= f.hidden_field :user_id, :value => current_user.id %>
                <%= f.text_field :quest_name, :'data-mini' => true, :placeholder => "Ask question ?" %>
               <br>
                <%#= f.submit "Send",:class=>"button gray",:style=>"width:15%;" %>
              <div id="err_msg"></div>
              <a class="button gray" href="#" data-ajax=false data-role="button" class="form_btn" id="form_btn_id" data-mini="true">Send</a>

          <% end %>
          <br>
          <hr>


          <script type="text/javascript">

              $(document).ready(function () {

                  $(function () {
                      $('.likes').live("click", function (e) {
                          var a = $(this).parent().parent().parent().parent().parent().parent().attr('id');
                          $(this).unbind('click').live('click', function () {
                              return false;
                          });
                          var data = {question_id:[]}
                          data["question_id"].push(a);
                          $.ajax({
                              url:"<%= voting_path %>",
                              type:"post",
                              data:JSON.stringify(data),
                              contentType:"application/json",
                              success:function (data) {
                                  $('#like_' + a).html(data+" likes")

                              }
                          });

                      });

                  });






                  $(function () {
                      $('#categoriesContent ul').hide();
                      $(document).ready(function () {
                          $('#songs_select').change(function () {
                              var a = $('#songs_select').val();
                              var data = {track_id:[]}
                              data["track_id"].push($('#songs_select').val());
                              $.getJSON("/desktop_questions_appending/" + data["track_id"], function (data) {
                                  $('#categoriesContent ul').html("");
                                  $('#categoriesContent ul').show();
                                  $('#question_form').append('<input type="hidden"  name="question_appending" value=' + a + '>');
                                  $.each(data, function (key, val) {
                                      val=val.split('|');
                                      if (val[6] == 1) {
                                          $('#categoriesContent ul').append('<li  id=' + val[0] + '>' +
                                                  '<a href="#"><h6>' + val[1] + ' asked ' + val[3] + '</h6>' +
                                                  '<table>' +
                                                  '<tr>' +
                                                  '<td  id="like_table">' +
                                                  '<h5 id="like_' + val[0] + '">' + val[4] + 'Likes</h5>' +
                                                  '</td>' +
                                                  '</tr>' +
                                                  '</table>' +
                                                  '</a>' +
                                                  '</li>');
                                      }
                                      else {
                                          $('#categoriesContent ul').append('<li  id=' + val[0] + '>' +
                                                  '<a href="#"><h6>' + val[1] + ' asked ' + val[3] + '</h6>' +
                                                  '<table>' +
                                                  '<tr>' +
                                                  '<td id="like_table">  ' +
                                                  '<input type="image" value="Likes" class="likes button grey" id="liking"  src="/assets/thumbs_up.png" style="max-height: 32px; ">' +
                                                  '</td> ' +
                                                  '<td>' +
                                                  ' <h5 id="like_' + val[0] + '">' + val[4] +'  Likes</h5>' +
                                                  '</td>' +
                                                  '</tr>' +
                                                  '</table>' +
                                                  '</a>' +
                                                  '</li>');



                                      }
                                  });
                                  function create_quest() {
                                      var data = {question_appending:[], quest_name:[]}
                                      data["question_appending"].push(a);
                                      data["quest_name"].push($('#questionable_quest_name').val());
                                      $.ajax({
                                          url:"<%= desktop_create_question_path %>",
                                          type:"post",
                                          data:JSON.stringify(data),
                                          contentType:"application/json",
                                          success:function (data) {

                                          }
                                      });

                                  }
                              });

                          });

                      });

                  });

                  });

             function question_default(){
                 var a = $('#songs_select').val();
                 var data = {track_id:[]}
                 data["track_id"].push($('#songs_select').val());
                 $.getJSON("/desktop_questions_appending/" + data["track_id"], function (data) {
                     $('#categoriesContent').show();
                     $('#categoriesContent ul').html("");
                     $('#question_form').append('<input type="hidden"  name="question_appending" value=' + a + '>');
                     $.each(data, function (key, val) {
                         val=val.split('|');
                         if (val[6] == 1) {
                             $('#categoriesContent ul').append('<li  id=' + val[0] + '>' +
                                     '<a href="#"><h6>' + val[1] + ' asked ' + val[3] + '</h6>' +
                                     '<table>' +
                                     '<tr>' +
                                     '<td  id="like_table">' +
                                     '<h5 id="like_' + val[0] + '">' + val[4] + 'Likes</h5>' +
                                     '</td>' +
                                     '</tr>' +
                                     '</table>' +
                                     '</a>' +
                                     '</li>');
                         }
                         else {
                             $('#categoriesContent ul').append('<li  id=' + val[0] + '>' +
                                     '<a href="#"><h6>' + val[1] + ' asked ' + val[3] + '</h6>' +
                                     '<table>' +
                                     '<tr>' +
                                     '<td id="like_table">  ' +
                                     '<input type="button" value="Likes" class="likes button gray" id="liking">' +
                                     '</td> ' +
                                     '<td>' +
                                     ' <h5 id="like_' + val[0] + '">' + val[4] + 'Likes</h5>' +
                                     '</td>' +
                                     '</tr>' +
                                     '</table>' +
                                     '</a>' +
                                     '</li>');



                         }
                     });
                     function create_quest() {
                         var data = {question_appending:[], quest_name:[]}
                         data["question_appending"].push(a);
                         data["quest_name"].push($('#questionable_quest_name').val());
                         $.ajax({
                             url:"<%= desktop_create_question_path %>",
                             type:"post",
                             data:JSON.stringify(data),
                             contentType:"application/json",
                             success:function (data) {

                             }
                         });

                     }
                 });
              }











              $('#form_btn_id').click(function(){
                  if ($("#genres_select").val()==""){
                  <%= add_gritter("Please Select Event Day", :title => "Error!",:image => :warning,:time => 2000  ) %>
                  }
                  else if ($("#artists_select").val()==""){

                  <%= add_gritter("Please Select Track Day", :title => "Error!",:image => :warning,:time => 2000  ) %>
                  }
                  else if ($('#songs_select').val()==""){
                  <%= add_gritter("Please Select Product", :title => "Error!",:image => :warning,:time => 2000  ) %>
                  }
                  else if ($('#questionable_quest_name').val()==""){

                  <%= add_gritter("Please Ask A Question", :title => "Error!",:image => :warning,:time => 2000  ) %>
                  }
                  else
                  {
                  <%= add_gritter("Your Question to the moderator for approval", :title => "Success",:image => :success,:time => 1000) %>
                      setTimeout(function(){
                          $('#question_form').submit();
                      },2000);



                  }
              });


          </script>



          <div class="nav-menu box" id="categoriesContent">
            <ul class="nav nav-list">
              <br>
            </ul>
          </div>
          </li>
        </ul>
      </div>
      <!----------------------End of events------------------------------>
    </div>

    <div class="span5">
      <div class="row-fluid">
        <div class="span12">
          <div class="black-box tex" style="max-height: 150px;">
            <div class="tab-header">
              Event Wall
            </div>
            <ul class="recent-comments" style="list-style: none;">
              <% @conference=Conference.last %>
              <% @user=current_user %>
              <% @graffiti=(User.all-(Follower.find_all_by_user_id_and_conference_id(@user.id, @conference.id).map { |f| User.find(f.follower_id) })-[current_user]-Organizer.all.map { |o| o.user }).map { |u| u.posts }.flatten.last(30).sort_by(&:created_at).reverse %>
              <% @graffiti.each do |post| %>

                  <li class="separator">
                    <div class="avatar pull-left">
                      <% if post.user.picture.blank? %>
                          <%= image_tag "avatar.png" %>
                      <% else %>
                          <%= image_tag(post.user.picture) %>
                      <% end %>
                    </div>
                    <div class="article-post">
                      <div class="user-info"> Posted
                        by <%= link_to post.user.name.titlecase, delegate_profile_index_path(post.user) %>
                        at <%= post.created_at %> </div>
                      <div class="user-content">"<%= post.name.truncate(10) %>"</div>
                    </div>
                  </li>
              <% end %>
            </ul>
          </div>
        </div>
      </div>
    </div>


    <!-------------------------->

    <div class="span5">
      <div class="row-fluid">
        <div class="span12">
          <div class="black-box tex" style="max-height: 350px;">
            <div class="tab-header">
              Splash Zone
            </div>
            <script>
                $(document).ready(function() {
                    $("#slider1").responsiveSlides({
                        auto:true, // Boolean: Animate automatically, true or false
                        speed:2500, // Integer: Speed of the transition, in milliseconds
                        timeout:8000, // Integer: Time between slide transitions, in milliseconds
                        random:true, // Boolean: Randomize the order of the slides, true or false
                        pause:false, // Boolean: Pause on hover, true or false
                        pauseControls:true, // Boolean: Pause when hovering controls, true or false
                        maxwidth:"", // Integer: Max-width of the slideshow, in pixels
                        navContainer:"", // Selector: Where controls should be appended to, default is after the 'ul'
                        manualControls:"", // Selector: Declare custom pager navigation
                        namespace:"rslides" // String: Change the default namespace used
                    });
                });
            </script>

            <style type="text/css">
                .img_style {
                    max-height: 200px;
                }
            </style>

            <ul class="recent-comments">
              <li class="separator" style="max-height: 300px;">
                <ul class="rslides" id="slider1">
                  <li><%= image_tag HomePageLogo.first.image_one.url, :class => "img_style" %></li>
                  <li><%= image_tag HomePageLogo.first.image_two.url, :class => "img_style" %></li>
                  <li><%= image_tag HomePageLogo.first.image_three.url, :class => "img_style" %></li>

                  <% @survey_q= SurveyQuestion.all %>
                  <% @survey_q.each do |s| %>
                      <div id="surveys">
                        <li class="img_style" id="<%= s.id %>"><%= s.quest %>
                          <table>
                            <% if !s.option_a.blank? %>
                                <tr>
                                  <td><%= radio_button_tag "survey_options", "1", true%></td>
                                  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= s.option_a %></td>
                            <% end %>
                            </tr>

                            <% if !s.option_b.blank? %>
                                <tr>
                                  <td><%= radio_button_tag "survey_options", "2", true%></td>
                                  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= s.option_b %></td>
                            <% end %>

                            </tr>
                            <% if !s.option_c.blank? %>
                                <tr>
                                  <td><%= radio_button_tag "survey_options", "3", true%></td>
                                  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= s.option_c %></td>
                                </tr>
                            <% end %>

                            <% if !s.option_d.blank? %>
                                <tr>
                                  <td><%= radio_button_tag "survey_options", "4", true%></td>
                                  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= s.option_d %></td>
                                </tr>
                            <% end %>
                          </table>
                        </li>
                      </div>
                  <% end %>
                </ul>
              </li>
              <li class="separator">

                <marquee id="tweet" style="color: white;">

                  <% @newsfeed=NewsFeed.all %>
                  <% @newsfeed.each do |n| %>
                      <%= n.feed_news %>
                  <% end %>
                </marquee>

              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>




    <script type="text/javascript">

        $(function () {
            $("input[name=survey_options]").click(function () {
                var a = $(this).parent().parent().parent().parent().parent().parent().attr('id');
                var value = $(this).val();
                var data = { user_id:[], survey_question_id:[], ans:[]}
                data["user_id"].push('<%= current_user.id%>');
                data["survey_question_id"].push(a);
                data["ans"].push(value);
                $.ajax({
                    url:"<%= survey_storing_path %>",
                    type:"post",
                    data:JSON.stringify(data),
                    contentType:"application/json",
                    success:function (data) {
                        <%= add_gritter("Thank You", :title => "Success",:image => :success,:time => 1000) %>
                    }
                });

            });


        });


//        $(function () {
//            $.get('/gettweets', function (data) {
//
//                data = data.split('", "')
//                $.each(data, function (index, val) {
//                    val = val.toString().replace(/"/, '').replace('[', '').replace(']', '');
//                    $('#tweet').append(val + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;')
//                });
//            });
//
//        });

    </script>


  </div>
</div>






